<!DOCTYPE html>
<html lang="en">

<!-- GENERATED FROM game.html.jinja -->

<head>
    <title>ERS-OL</title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        body {
            text-align: center;
            font-family: Arial, Helvetica, sans-serif;
            color: #eee;
            background-color: #333;
        }

        p {
            font-size: 20px;
        }

        h1 {
            font-size: 50px;
        }

        img {
            visibility: hidden;
        }
    </style>
</head>

<body onload="init()">
    <h1>ERS-OL</h1>
    <p>Hello, player!</p>
    <canvas id="mainCanvas" width="500" height="500" style="border:1px solid black;"></canvas>
    <footer id="copyright">&copy; 2021 NitroGuy</footer>

    <div id="cardImages" hidden>
        
        <img src="cards/cardBack_blue1.png" id="cards/cardBack_blue1.png">
        
        <img src="cards/cardBack_blue2.png" id="cards/cardBack_blue2.png">
        
        <img src="cards/cardBack_blue3.png" id="cards/cardBack_blue3.png">
        
        <img src="cards/cardBack_blue4.png" id="cards/cardBack_blue4.png">
        
        <img src="cards/cardBack_blue5.png" id="cards/cardBack_blue5.png">
        
        <img src="cards/cardBack_green1.png" id="cards/cardBack_green1.png">
        
        <img src="cards/cardBack_green2.png" id="cards/cardBack_green2.png">
        
        <img src="cards/cardBack_green3.png" id="cards/cardBack_green3.png">
        
        <img src="cards/cardBack_green4.png" id="cards/cardBack_green4.png">
        
        <img src="cards/cardBack_green5.png" id="cards/cardBack_green5.png">
        
        <img src="cards/cardBack_red1.png" id="cards/cardBack_red1.png">
        
        <img src="cards/cardBack_red2.png" id="cards/cardBack_red2.png">
        
        <img src="cards/cardBack_red3.png" id="cards/cardBack_red3.png">
        
        <img src="cards/cardBack_red4.png" id="cards/cardBack_red4.png">
        
        <img src="cards/cardBack_red5.png" id="cards/cardBack_red5.png">
        
        <img src="cards/cardClubs10.png" id="cards/cardClubs10.png">
        
        <img src="cards/cardClubs2.png" id="cards/cardClubs2.png">
        
        <img src="cards/cardClubs3.png" id="cards/cardClubs3.png">
        
        <img src="cards/cardClubs4.png" id="cards/cardClubs4.png">
        
        <img src="cards/cardClubs5.png" id="cards/cardClubs5.png">
        
        <img src="cards/cardClubs6.png" id="cards/cardClubs6.png">
        
        <img src="cards/cardClubs7.png" id="cards/cardClubs7.png">
        
        <img src="cards/cardClubs8.png" id="cards/cardClubs8.png">
        
        <img src="cards/cardClubs9.png" id="cards/cardClubs9.png">
        
        <img src="cards/cardClubsA.png" id="cards/cardClubsA.png">
        
        <img src="cards/cardClubsJ.png" id="cards/cardClubsJ.png">
        
        <img src="cards/cardClubsK.png" id="cards/cardClubsK.png">
        
        <img src="cards/cardClubsQ.png" id="cards/cardClubsQ.png">
        
        <img src="cards/cardDiamonds10.png" id="cards/cardDiamonds10.png">
        
        <img src="cards/cardDiamonds2.png" id="cards/cardDiamonds2.png">
        
        <img src="cards/cardDiamonds3.png" id="cards/cardDiamonds3.png">
        
        <img src="cards/cardDiamonds4.png" id="cards/cardDiamonds4.png">
        
        <img src="cards/cardDiamonds5.png" id="cards/cardDiamonds5.png">
        
        <img src="cards/cardDiamonds6.png" id="cards/cardDiamonds6.png">
        
        <img src="cards/cardDiamonds7.png" id="cards/cardDiamonds7.png">
        
        <img src="cards/cardDiamonds8.png" id="cards/cardDiamonds8.png">
        
        <img src="cards/cardDiamonds9.png" id="cards/cardDiamonds9.png">
        
        <img src="cards/cardDiamondsA.png" id="cards/cardDiamondsA.png">
        
        <img src="cards/cardDiamondsJ.png" id="cards/cardDiamondsJ.png">
        
        <img src="cards/cardDiamondsK.png" id="cards/cardDiamondsK.png">
        
        <img src="cards/cardDiamondsQ.png" id="cards/cardDiamondsQ.png">
        
        <img src="cards/cardHearts10.png" id="cards/cardHearts10.png">
        
        <img src="cards/cardHearts2.png" id="cards/cardHearts2.png">
        
        <img src="cards/cardHearts3.png" id="cards/cardHearts3.png">
        
        <img src="cards/cardHearts4.png" id="cards/cardHearts4.png">
        
        <img src="cards/cardHearts5.png" id="cards/cardHearts5.png">
        
        <img src="cards/cardHearts6.png" id="cards/cardHearts6.png">
        
        <img src="cards/cardHearts7.png" id="cards/cardHearts7.png">
        
        <img src="cards/cardHearts8.png" id="cards/cardHearts8.png">
        
        <img src="cards/cardHearts9.png" id="cards/cardHearts9.png">
        
        <img src="cards/cardHeartsA.png" id="cards/cardHeartsA.png">
        
        <img src="cards/cardHeartsJ.png" id="cards/cardHeartsJ.png">
        
        <img src="cards/cardHeartsK.png" id="cards/cardHeartsK.png">
        
        <img src="cards/cardHeartsQ.png" id="cards/cardHeartsQ.png">
        
        <img src="cards/cardJoker.png" id="cards/cardJoker.png">
        
        <img src="cards/cardSpades10.png" id="cards/cardSpades10.png">
        
        <img src="cards/cardSpades2.png" id="cards/cardSpades2.png">
        
        <img src="cards/cardSpades3.png" id="cards/cardSpades3.png">
        
        <img src="cards/cardSpades4.png" id="cards/cardSpades4.png">
        
        <img src="cards/cardSpades5.png" id="cards/cardSpades5.png">
        
        <img src="cards/cardSpades6.png" id="cards/cardSpades6.png">
        
        <img src="cards/cardSpades7.png" id="cards/cardSpades7.png">
        
        <img src="cards/cardSpades8.png" id="cards/cardSpades8.png">
        
        <img src="cards/cardSpades9.png" id="cards/cardSpades9.png">
        
        <img src="cards/cardSpadesA.png" id="cards/cardSpadesA.png">
        
        <img src="cards/cardSpadesJ.png" id="cards/cardSpadesJ.png">
        
        <img src="cards/cardSpadesK.png" id="cards/cardSpadesK.png">
        
        <img src="cards/cardSpadesQ.png" id="cards/cardSpadesQ.png">
        
    </div>

    <script>
        var cardImages = [
            
        document.getElementById("cards/cardBack_blue1.png"),
            
        document.getElementById("cards/cardBack_blue2.png"),
            
        document.getElementById("cards/cardBack_blue3.png"),
            
        document.getElementById("cards/cardBack_blue4.png"),
            
        document.getElementById("cards/cardBack_blue5.png"),
            
        document.getElementById("cards/cardBack_green1.png"),
            
        document.getElementById("cards/cardBack_green2.png"),
            
        document.getElementById("cards/cardBack_green3.png"),
            
        document.getElementById("cards/cardBack_green4.png"),
            
        document.getElementById("cards/cardBack_green5.png"),
            
        document.getElementById("cards/cardBack_red1.png"),
            
        document.getElementById("cards/cardBack_red2.png"),
            
        document.getElementById("cards/cardBack_red3.png"),
            
        document.getElementById("cards/cardBack_red4.png"),
            
        document.getElementById("cards/cardBack_red5.png"),
            
        document.getElementById("cards/cardClubs10.png"),
            
        document.getElementById("cards/cardClubs2.png"),
            
        document.getElementById("cards/cardClubs3.png"),
            
        document.getElementById("cards/cardClubs4.png"),
            
        document.getElementById("cards/cardClubs5.png"),
            
        document.getElementById("cards/cardClubs6.png"),
            
        document.getElementById("cards/cardClubs7.png"),
            
        document.getElementById("cards/cardClubs8.png"),
            
        document.getElementById("cards/cardClubs9.png"),
            
        document.getElementById("cards/cardClubsA.png"),
            
        document.getElementById("cards/cardClubsJ.png"),
            
        document.getElementById("cards/cardClubsK.png"),
            
        document.getElementById("cards/cardClubsQ.png"),
            
        document.getElementById("cards/cardDiamonds10.png"),
            
        document.getElementById("cards/cardDiamonds2.png"),
            
        document.getElementById("cards/cardDiamonds3.png"),
            
        document.getElementById("cards/cardDiamonds4.png"),
            
        document.getElementById("cards/cardDiamonds5.png"),
            
        document.getElementById("cards/cardDiamonds6.png"),
            
        document.getElementById("cards/cardDiamonds7.png"),
            
        document.getElementById("cards/cardDiamonds8.png"),
            
        document.getElementById("cards/cardDiamonds9.png"),
            
        document.getElementById("cards/cardDiamondsA.png"),
            
        document.getElementById("cards/cardDiamondsJ.png"),
            
        document.getElementById("cards/cardDiamondsK.png"),
            
        document.getElementById("cards/cardDiamondsQ.png"),
            
        document.getElementById("cards/cardHearts10.png"),
            
        document.getElementById("cards/cardHearts2.png"),
            
        document.getElementById("cards/cardHearts3.png"),
            
        document.getElementById("cards/cardHearts4.png"),
            
        document.getElementById("cards/cardHearts5.png"),
            
        document.getElementById("cards/cardHearts6.png"),
            
        document.getElementById("cards/cardHearts7.png"),
            
        document.getElementById("cards/cardHearts8.png"),
            
        document.getElementById("cards/cardHearts9.png"),
            
        document.getElementById("cards/cardHeartsA.png"),
            
        document.getElementById("cards/cardHeartsJ.png"),
            
        document.getElementById("cards/cardHeartsK.png"),
            
        document.getElementById("cards/cardHeartsQ.png"),
            
        document.getElementById("cards/cardJoker.png"),
            
        document.getElementById("cards/cardSpades10.png"),
            
        document.getElementById("cards/cardSpades2.png"),
            
        document.getElementById("cards/cardSpades3.png"),
            
        document.getElementById("cards/cardSpades4.png"),
            
        document.getElementById("cards/cardSpades5.png"),
            
        document.getElementById("cards/cardSpades6.png"),
            
        document.getElementById("cards/cardSpades7.png"),
            
        document.getElementById("cards/cardSpades8.png"),
            
        document.getElementById("cards/cardSpades9.png"),
            
        document.getElementById("cards/cardSpadesA.png"),
            
        document.getElementById("cards/cardSpadesJ.png"),
            
        document.getElementById("cards/cardSpadesK.png"),
            
        document.getElementById("cards/cardSpadesQ.png"),
            
        ]
        const RANK_NAME = ["NONE", "A", "2", "3", "4", "5", "6", "7", "8", "9", "10", "J", "Q", "K"]

        var gameArea = {
            components: {},
            keys: [],
            framerate: 60,
            start: function ()
            {
                this.canvas = document.getElementById("mainCanvas")
                this.context = this.canvas.getContext("2d")
                window.addEventListener('keydown', function (e)
                {
                    if (!gameArea.keys[39] && e.keyCode == 39)
                    {
                        gameArea.components["testImage"].x += 10
                    }
                    else if (!gameArea.keys[38] && e.keyCode == 38)
                    {
                        //gameArea.components["cards/cardSpadesA.png"].deal()
                        for (let rank = 1; rank < 14; rank++)
                        {
                            gameArea.components[["cards/card", "Spades", RANK_NAME[rank], ".png"].join("")].deal()
                            gameArea.components[["cards/card", "Hearts", RANK_NAME[rank], ".png"].join("")].deal()
                            gameArea.components[["cards/card", "Diamonds", RANK_NAME[rank], ".png"].join("")].deal()
                            gameArea.components[["cards/card", "Clubs", RANK_NAME[rank], ".png"].join("")].deal()
                        }
                    }
                    gameArea.keys[e.keyCode] = true
                })
                window.addEventListener('keyup', function (e)
                {
                    gameArea.keys[e.keyCode] = false
                })

                this.interval = setInterval(updateGameArea, Math.ceil(1000 / gameArea.framerate))
            },
            clear: function ()
            {
                this.context.clearRect(0, 0, this.canvas.width, this.canvas.height)
            },
            update: function ()
            {
                for (componentName in this.components)
                {
                    component = this.components[componentName]
                    component.update()
                }
            }

        }

        function imgComponent(name, image, x, y)
        {
            this.name = name
            this.image = image
            this.x = x
            this.y = y
            this.update = function ()
            {
                gameArea.context.drawImage(this.image, this.x, this.y)
            }

            gameArea.components[this.name] = this
        }

        function card(rank, suit, x, y)
        {
            this.rank = rank  // first letter is always capitalized
            this.suit = suit
            this.name = ["cards/card", this.suit, RANK_NAME[rank], ".png"].join("")
            this.image = document.getElementById(this.name)
            this.x = x
            this.y = y
            this.rotation = 0
            this.width = 140
            this.height = 190
            this.hidden = true
            this.moving = false
            this.update = function ()
            {
                if (!this.hidden)
                {
                    // x and y are the center of the card
                    context = gameArea.context
                    context.save()
                    context.translate(this.x, this.y)
                    context.rotate(this.rotation)
                    context.drawImage(this.image, this.width / -2, this.height / -2)
                    context.restore()
                }
            }
            this.deal = function ()
            {
                if (!this.moving)
                {
                    this.hidden = false
                    this.x = (gameArea.canvas.width / 2)
                    this.y = gameArea.canvas.height + this.height
                    this.moving = true
                    this.cycle = 0
                    this.interval = setInterval(this.dealMovement, Math.ceil(1000 / gameArea.framerate), this.name)
                    console.log("dealing!")
                }
            }
            this.dealMovement = function (name)
            {
                cycle = gameArea.components[name].cycle
                MOVEMENT_LENGTH = 4
                if (cycle <= MOVEMENT_LENGTH)
                {
                    canvasHeight = gameArea.canvas.height
                    gameArea.components[name].y = (canvasHeight / 2) * Math.sin(cycle / (MOVEMENT_LENGTH / (-0.5 * Math.PI))) + (canvasHeight)
                    gameArea.components[name].rotation = (Math.PI / 2) * Math.sin(cycle / (MOVEMENT_LENGTH / (-0.5 * Math.PI))) + (Math.PI / 2)

                    gameArea.components[name].cycle++
                    console.log("deal moving!")
                }
                else
                {
                    clearInterval(gameArea.components[name].interval)
                    gameArea.components[name].moving = false
                    console.log("done moving!")
                }
            }
            gameArea.components[this.name] = this
        }

        function updateGameArea()
        {
            gameArea.clear()

            gameArea.update()
        }

        function init()
        {
            gameArea.start()
            new imgComponent("testImage", cardImages[48], 50, 50)
            //new card(1, "Spades", 50, 50)
            for (let rank = 1; rank < 14; rank++)
            {
                new card(rank, "Spades", 0, 0)
                new card(rank, "Hearts", 0, 0)
                new card(rank, "Diamonds", 0, 0)
                new card(rank, "Clubs", 0, 0)
            }
        }
    </script>
</body>

</html>